flowchart TD
  A[Start: field value] --> B{Value is null/empty?}
  B -->|Yes| Z[Return None]
  B -->|No| C[Normalize + split value into sentences]
  C --> D{Any value sentences?}
  D -->|No| Z
  D -->|Yes| E[Build hypotheses<br/>- value-only<br/>- full hypothesis]
  E --> F[BM25 over sentence index]
  F --> G{BM25 hits?}
  G -->|0| H[Semantic search top-K]
  G -->|1| I[Use single BM25 hit, no NLI]
  G -->|multiple| J[Cap BM25 to 20 + check strong-single]
  J --> K{Strong single?}
  K -->|Yes| I
  K -->|No| L[Select candidate indices<br/>BM25 <= K or rerank by semantic]
  H --> L
  I --> M[Span match + map offsets]
  L --> N[Primary NLI on candidates<br/>hypothesis: value-only if policy else full]
  N --> O{Any entailment?}
  O -->|Yes| P[Use entailment candidates]
  O -->|No| Q{Value-only fallback? <br/>non-numeric, not already value-only}
  Q -->|Yes| R[Value-only NLI on candidates]
  Q -->|No| S[Combined-premise NLI]
  R --> T{Any entailment?}
  T -->|Yes| P
  T -->|No| S
  S --> U[Concatenate top-N candidates]
  U --> V[Combined NLI<br/>hypothesis: value-only if policy else full]
  V --> W{Entailment?}
  W -->|Yes| X[Use all N candidates, diffuse evidence]
  W -->|No| Y{Neutral candidates?}
  Y -->|Yes| AA[LLM supports check on neutral]
  Y -->|No| AB[No evidence]
  AA --> AC[Use LLM-supported candidates]

  P --> M
  X --> M
  AC --> M
  AB --> Z

  M --> AD[Match value span in sentence<br/>exact/fuzzy]
  AD --> AE{Span found?}
  AE -->|Yes| AF[Use span offsets]
  AE -->|No| AG[Use full sentence span]
  AF --> AH[Deduplicate spans]
  AG --> AH
  AH --> AI[Return evidence list]
